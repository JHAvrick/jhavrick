[{"_path":"/articles/self-host","_dir":"articles","_draft":false,"_partial":false,"_locale":"","title":"Self-Hosting A Chrome Extension","description":"For rapid prototyping and production-like testing, you can skip the Chrome Web Store's review process and deploy your extension directly to a device or browser enrolled in your Workspace organization. Neat.","cover":"/articles/self-host-intro.png","author":{"name":"Joshua Avrick"},"date":"2024-01-10T00:00:00.000Z","layout":"article","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"self-hosting-a-chrome-extension"},"children":[{"type":"text","value":"Self-Hosting A Chrome Extension"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For rapid prototyping and production-like testing, you can skip the Chrome Web Store's review process and deploy your extension directly to a device or browser enrolled in your Workspace organization. Neat."}]},{"type":"element","tag":"h2","props":{"id":"a-note"},"children":[{"type":"text","value":"A Note"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I've written a library which automates and streamlines this process for you: "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/crx-server","rel":["nofollow"]},"children":[{"type":"text","value":"crx-server"}]},{"type":"text","value":". It takes two minutes and minimal configuration - you could probably be up and running faster than it takes to read this article!"}]},{"type":"element","tag":"h2","props":{"id":"why-self-host"},"children":[{"type":"text","value":"Why self-host?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I can conceive of two reasons you might want to self-host a chrome extension:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You've developed an extension for internal organizational use and want to deploy it without first publishing to the Chrome Web Store, even if unlisted."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You want to deploy and test your extension in a production-like environment without the time and overhead required to publish to the Chrome Web Store."}]}]},{"type":"element","tag":"h2","props":{"id":"what-do-you-need"},"children":[{"type":"text","value":"What do you need?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sadly, you'll need "},{"type":"element","tag":"a","props":{"href":"https://admin.google.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Google Workspace"}]},{"type":"text","value":" to actually deploy your extension after we set everything up. It should be possible to create a trial account (don't quote me on that), or even to sign up for a permanent demo account with Education/Enterprise features by joining Google's "},{"type":"element","tag":"a","props":{"href":"https://partners.cloud.google.com/?hl=en","rel":["nofollow"]},"children":[{"type":"text","value":"Partner Program"}]},{"type":"text","value":", though I haven't personally attempted this process."}]},{"type":"element","tag":"h2","props":{"id":"how-does-this-work"},"children":[{"type":"text","value":"How does this work?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hosting an extension is as simple as it is poorly documented."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's the gist - you create a server with two easy endpoints, one which has metadata about your extension, and one which delivers the extension itself. After your extension has been installed by a browser, your metadata endpoint will be polled periodically checking for updates to the extension version. If the version is higher than the browser's installed version, the new extension will be installed. And that's pretty much it."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The rest of this article will fill you in on the specifics!"}]},{"type":"element","tag":"h1","props":{"id":"steps"},"children":[{"type":"text","value":"Steps"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Step 1"}]},{"type":"text","value":" - Set up our server and endpoints"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Step 2"}]},{"type":"text","value":" - Make it public with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ngrok"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Step 3"}]},{"type":"text","value":" - Pack our CRX"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Step 4"}]},{"type":"text","value":" - Create our "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Step 5"}]},{"type":"text","value":" - Deploy via Workspace"}]}]},{"type":"element","tag":"h2","props":{"id":"dependencies"},"children":[{"type":"text","value":"Dependencies"}]},{"type":"element","tag":"pre","props":{"code":"npm install --save-dev express ngrok\n","language":"js","meta":"","className":"language-js shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"npm install "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"--"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"save"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"dev express ngrok\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"step-1-set-up-our-server-and-endpoints"},"children":[{"type":"text","value":"Step 1: Set up our server and endpoints"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We are first going to set up a bare-bones "},{"type":"element","tag":"a","props":{"href":"https://expressjs.com/","rel":["nofollow"]},"children":[{"type":"text","value":"express"}]},{"type":"text","value":" server with two endpoints. We don't actually have anything to serve on those endpoints yet, but we'll get to that."}]},{"type":"element","tag":"pre","props":{"code":"const path = require('path');\nconst express = require('express');\nconst app = express();\n\n//One endpoint for our update.xml\napp.get('/update.xml', (req, res) => {\n    res.contentType('application/xml');\n    res.sendFile(path.resolve('public', 'update.xml'));\n});\n\n//And one for the actual crx\napp.get('/extension', (req, res) => {\n    res.setHeader('content-type', 'application/x-chrome-extension');\n    res.sendFile(path.resolve('public', 'extension.crx'));\n});\n\napp.listen(9000, async () => {\n    //...\n});\n","language":"js","meta":"","className":"language-js shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" path"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'path'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'express'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"//One endpoint for our update.xml\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"app."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'/update.xml'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E36209;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E36209;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    res."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"contentType"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'application/xml'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    res."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"sendFile"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(path."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"resolve"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'public'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'update.xml'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"});\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"//And one for the actual crx\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"app."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'/extension'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E36209;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E36209;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    res."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"setHeader"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'content-type'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'application/x-chrome-extension'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    res."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"sendFile"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(path."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"resolve"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'public'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'extension.crx'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"});\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"app."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"listen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"9000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"    //...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"});\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's it! In this snippet we are serving two files (TBD) out of a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" directory, from two separate endpoints, and we are setting the appropriate content types."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Save this snippet somewhere and call it "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server.js"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"step-2-make-it-public-with-ngrok"},"children":[{"type":"text","value":"Step 2: Make it public with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ngrok"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So that gives us a local server, but we need more. We need a public URL that browsers can access to download our extension. To do this, in a very temporary way, we're going to create an "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/ngrok","rel":["nofollow"]},"children":[{"type":"text","value":"ngrok"}]},{"type":"text","value":" tunnel, which will expose our local server to the wider web until we choose to disconnect it."}]},{"type":"element","tag":"pre","props":{"code":"const ngrok = require('ngrok');\n\n// ...routes\n\napp.listen(9000, async () => {\n\n    //Connect ngrok to our now-live server\n    const url = await ngrok.connect({ \n        authtoken: '<ngrok auth token>', \n        port: 9000 \n    });\n\n    //Log the public route to our update endpoint for later use\n    console.log(`${url}/update.xml`);\n    console.log(`${url}/extension`);\n});\n","language":"js","meta":"","className":"language-js shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" ngrok"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'ngrok'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"// ...routes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"app."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"listen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"9000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"    //Connect ngrok to our now-live server\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ngrok."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"connect"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"({ \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        authtoken: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'<ngrok auth token>'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        port: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"9000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"    //Log the public route to our update endpoint for later use\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"`${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"}/update.xml`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"`${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"}/extension`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"});\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This will connect us to ngrok and also provide us with a couple important URLs which we'll need for the next few steps. If you don't have an "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"authtoken"}]},{"type":"text","value":", you will want to sign up for an free ngrok account before moving on."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now run the server using "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"node server"}]},{"type":"text","value":" and copy the first URL we printed out."}]},{"type":"element","tag":"h2","props":{"id":"step-3-pack-our-crx"},"children":[{"type":"text","value":"Step 3: Pack our CRX"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You may be wondering why we set up and even started our server before even finalizing the extension package. Here is why:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There is a property "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update_url"}]},{"type":"text","value":" which must be present in our "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"manifest.json"}]},{"type":"text","value":" and it must contain a URL indicating to the browser where to look for extension updates. That's the URL we just copied."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Paste it into your manifest:"}]},{"type":"element","tag":"pre","props":{"code":"{\n    \"manifest_version\": 2,\n    \"name\": \"Chrome Extension\",\n    \"version\": \"1.0.0\",\n    \"update_url\": \"<url from ngrok ending in /update.xml>\"\n    ...\n}\n","language":"json","meta":"","className":"language-json shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"    \"manifest_version\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"    \"name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Chrome Extension\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"    \"version\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"1.0.0\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"    \"update_url\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"<url from ngrok ending in /update.xml>\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"    ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ok, nice. Now we can pack our extension into its final form, a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".crx"}]},{"type":"text","value":", which is just a glorified "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".zip"}]},{"type":"text","value":" archive containing all of our extension files. We could automate this step, but that's a little outside the scope of this article, so we'll just proceed the old-fashioned way:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Navigate to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chrome://extensions/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Toggle on \"Developer Mode\" (top right)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Click \"Pack Extension\""}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Select your unpacked extension directory\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If you already have a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".pem"}]},{"type":"text","value":" key file, I wouldn't use it for this unless you're deploying a production extension to your organization. Chrome will generate a new one for you if not."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now if you haven't already, create a directory next to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server.js"}]},{"type":"text","value":" called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" and throw the CRX file in there. Our server is already actively serving from this directory. Rename the CRX file to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"extension.crx"}]},{"type":"text","value":" if necessary."}]},{"type":"element","tag":"h3","props":{"id":"step-4-create-our-updatexml"},"children":[{"type":"text","value":"Step 4: Create our "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now for the second endpoint, a simple XML with some information about our extension:"}]},{"type":"element","tag":"pre","props":{"code":"<?xml version='1.0' encoding='UTF-8'?>\n<gupdate xmlns='http://www.google.com/update2/response' protocol='2.0'>\n  <app appid='<your extension id>'>\n    <updatecheck codebase='<ngrok url ending /extension>' version='1.0.0' prodversionmin='64.0.3242' />\n  </app>\n</gupdate>\n","language":"xml","meta":"","className":"language-xml shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"<?"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"xml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" version"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'1.0'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" encoding"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'UTF-8'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"?>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"gupdate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" xmlns"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'http://www.google.com/update2/response'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" protocol"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'2.0'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" appid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'<your extension id>'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"updatecheck"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" codebase"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'<ngrok url ending /extension>'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" version"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'1.0.0'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" prodversionmin"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"'64.0.3242'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" />\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"  </"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#22863A;--shiki-dark:#85E89D"},"children":[{"type":"text","value":"gupdate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":">\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Paste this into a file called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]},{"type":"text","value":" in the public directory and then we'll fill in the gaps."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Replace "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<your extension id>"}]},{"type":"text","value":" with (you guessed it) your extension ID."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Replace "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<ngrok url ending /extension>"}]},{"type":"text","value":" with the second URL we copied from ngrok, ending in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/extension"}]},{"type":"text","value":". This URl tells browsers where to download the extension from."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you don't kow your extension ID you can just drag the CRX we created into "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chrome://extensions/"}]},{"type":"text","value":" and it will be displayed. Chrome likely won't let you enabled the extension, but you can still see the ID."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Match the version on the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<updatecheck />"}]},{"type":"text","value":" element to the version in your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"manifest.json"}]},{"type":"text","value":". We will increment this version whenever we want to force an update to our extension."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"disabled-extension","src":"/articles/disabled-extension.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"step-5-deploy-via-workspace"},"children":[{"type":"text","value":"Step 5: Deploy via Workspace"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alright, time to put it all together. At this point your filesystem should look something like this:"}]},{"type":"element","tag":"pre","props":{"code":"├── public\n│   ├── extension.crx\n│   └── update.xml\n└── server.js (active on port 9000 <-- ngrok)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"├── public\n│   ├── extension.crx\n│   └── update.xml\n└── server.js (active on port 9000 <-- ngrok)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note that if your server crashes or "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ngrok"}]},{"type":"text","value":" disconnects, you'll need to restart the server and update the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]},{"type":"text","value":" file with the new URL as well as the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update_url"}]},{"type":"text","value":" in your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"manifest.json"}]},{"type":"text","value":" (unless you've configured ngrok to use a static domain), which means you'll also need to repack the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".crx"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"(Or you could just "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/crx-server","rel":["nofollow"]},"children":[{"type":"text","value":"crx-server"}]},{"type":"text","value":" and save yourself the trouble!)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You should be able to visit either of our endpoints in your browser and see the appropriate content. I would recommend taking a quick gander at your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/udpate.xml"}]},{"type":"text","value":" and make sure everything looks cosher."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This last step is done entirely in Google Workspace. We're going to deploy our extension to a device or browser which is enrolled in our organization. If you're familiar with Workspace, this should be pretty straightforward."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Navigate to the "},{"type":"element","tag":"a","props":{"href":"https://admin.google.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Google Admin Console"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Go to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Devices > Chrome > Apps & Extensions > Users & browsers"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Select the Organizational Unit you want to deploy to"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Click \"Add\" (bottom right) and select \"Add Chrome app or extension by ID\""}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workspace-apps.png","src":"/articles/workspace-apps.png"},"children":[]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"From the dropdown, select \"From a custom URL\""}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workspace-custom-url.png","src":"/articles/workspace-custom-url.png"},"children":[]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Paste in your extension ID and the URL to your ngrok "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]},{"type":"text","value":" file and save"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Lastly, click \"Force install\" to deploy the extension to all devices/browsers in the selected organizational unit."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"workspace-force-install.png","src":"/articles/workspace-force-install.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"done"},"children":[{"type":"text","value":"Done!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's it! You should now be able to see your extension in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chrome://extensions/"}]},{"type":"text","value":" on any device or browser enrolled in your organization. If you want to update the extension, simply increment the version in your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"manifest.json"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"update.xml"}]},{"type":"text","value":" and wait for the browser to poll for updates, or manually check for updates in the target browser at "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chrome://extensions/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hopefully this was enlightening and at the very least provided you with a jumping off point! If you have any questions or comments, feel free to reach out to me via the "},{"type":"element","tag":"a","props":{"href":"/contact"},"children":[{"type":"text","value":"contact form"}]},{"type":"text","value":" on this blog."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As a final note and reminder, you can also check out my module which automates and streamlines this process for you:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"NPM: "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/crx-server","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.npmjs.com/package/crx-server"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"GitHub: "},{"type":"element","tag":"a","props":{"href":"https://github.com/JHAvrick/crx-server","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/JHAvrick/crx-server"}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"a-note","depth":2,"text":"A Note"},{"id":"why-self-host","depth":2,"text":"Why self-host?"},{"id":"what-do-you-need","depth":2,"text":"What do you need?"},{"id":"how-does-this-work","depth":2,"text":"How does this work?"},{"id":"dependencies","depth":2,"text":"Dependencies"},{"id":"step-1-set-up-our-server-and-endpoints","depth":2,"text":"Step 1: Set up our server and endpoints"},{"id":"step-2-make-it-public-with-ngrok","depth":2,"text":"Step 2: Make it public with ngrok"},{"id":"step-3-pack-our-crx","depth":2,"text":"Step 3: Pack our CRX","children":[{"id":"step-4-create-our-updatexml","depth":3,"text":"Step 4: Create our update.xml"}]},{"id":"step-5-deploy-via-workspace","depth":2,"text":"Step 5: Deploy via Workspace"},{"id":"done","depth":2,"text":"Done!"}]}},"_type":"markdown","_id":"content:articles:1.self-host.md","_source":"content","_file":"articles/1.self-host.md","_extension":"md"}]